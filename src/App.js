import "./styles.css";
import MyPlot from "./myPlot"
import * as d3 from "d3";
import { useRef, useEffect, useState } from "react";


function App() {
  const [data, setData] = useState();
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const offset = new Date().getTimezoneOffset();

    d3.csv("/ubcSSf2DWaveFields30m.csv", d3.autoType).then(dataRaw => {
      return dataRaw.map(d => {
        d.date = new Date(d.time.getTime() - offset*60*1000)
      return d})

    }).then(dataout => {
      console.log(dataout)
      setData(dataout);
      setLoading(false);
    });
  }, []);

  return (
    <div className="App">
      <h1>Plot in React</h1>
      {loading && <div>loading</div>}
      {!loading && <MyPlot
        data={data}
      />}
    </div>
  );
}

export default App;

// https://salishsea.eos.ubc.ca/erddap/griddap/ubcSSf2DWaveFields30mV17-02.csv0?ucur[(2023-02-02T05:30:00Z):1:(2023-02-04T05:30:00Z)][(48.414):1:(48.414)][(235.939):1:(235.939)],vcur[(2023-02-02T05:30:00Z):1:(2023-02-04T05:30:00Z)][(48.414):1:(48.414)][(235.939):1:(235.939)],uwnd[(2023-02-02T05:30:00Z):1:(2023-02-04T05:30:00Z)][(48.414):1:(48.414)][(235.939):1:(235.939)],vwnd[(2023-02-02T05:30:00Z):1:(2023-02-04T05:30:00Z)][(48.414):1:(48.414)][(235.939):1:(235.939)],hs[(2023-02-02T05:30:00Z):1:(2023-02-04T05:30:00Z)][(48.414):1:(48.414)][(235.939):1:(235.939)],lm[(2023-02-02T05:30:00Z):1:(2023-02-04T05:30:00Z)][(48.414):1:(48.414)][(235.939):1:(235.939)],t02[(2023-02-02T05:30:00Z):1:(2023-02-04T05:30:00Z)][(48.414):1:(48.414)][(235.939):1:(235.939)],fp[(2023-02-02T05:30:00Z):1:(2023-02-04T05:30:00Z)][(48.414):1:(48.414)][(235.939):1:(235.939)],dir[(2023-02-02T05:30:00Z):1:(2023-02-04T05:30:00Z)][(48.414):1:(48.414)][(235.939):1:(235.939)],dp[(2023-02-02T05:30:00Z):1:(2023-02-04T05:30:00Z)][(48.414):1:(48.414)][(235.939):1:(235.939)],wcc[(2023-02-02T05:30:00Z):1:(2023-02-04T05:30:00Z)][(48.414):1:(48.414)][(235.939):1:(235.939)],wch[(2023-02-02T05:30:00Z):1:(2023-02-04T05:30:00Z)][(48.414):1:(48.414)][(235.939):1:(235.939)],utwo[(2023-02-02T05:30:00Z):1:(2023-02-04T05:30:00Z)][(48.414):1:(48.414)][(235.939):1:(235.939)],vtwo[(2023-02-02T05:30:00Z):1:(2023-02-04T05:30:00Z)][(48.414):1:(48.414)][(235.939):1:(235.939)],foc[(2023-02-02T05:30:00Z):1:(2023-02-04T05:30:00Z)][(48.414):1:(48.414)][(235.939):1:(235.939)],uuss[(2023-02-02T05:30:00Z):1:(2023-02-04T05:30:00Z)][(48.414):1:(48.414)][(235.939):1:(235.939)]